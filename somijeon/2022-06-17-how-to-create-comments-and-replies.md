# 💡 비전공자에게 내새끼(나의 코딩) 설명하기 시리즈 1️⃣ 

## - 댓글과 대댓글 뒤에 숨어있는 피, 땀, 눈물(feat. BTS)

### 1. 댓글의 기본 구성

- `id`: 각각의 댓글은 모두 데이터베이스 안에서 고유한 아이디를 가지지. 사용자의 고유한 아이디만 있다면 그 사람의 모든 댓글까지 굳이 아이디가 있어야 할까? 라고 생각할 수도 있어. 하지만 모든 댓글의 아이디가 고유하지 않고 중복되는 아이디가 있거나 하면 특정 댓글의 수정이나 삭제를 눌렀을 때 엄한 댓글이 삭제될 수도 있잖아? 그래서 모든 댓글은 아이덴티티가 필요해.
- `userId`: 어떤 사용자가 쓴 댓글인지 당연히 알 수 있어야 겠지. 보통 사용자의 닉네임이나 프로필 사진, 개인 정보 등을 모아놓은 데이터베이스가 있기 마련이고 우리는 그 정보를 끌어 와서 댓글의 고유한 아이디와 짝지어 놓는 거야.
- `postId`: 댓글만 덩그러니 있는 경우는 없지? 보통 사진이나 글의 포스팅 아래 달리니까 이 댓글이 어떤 포스팅에 달린 것인지 그 포스팅의 고유한 아이디도 알아야 하지.
- `content`: 이게 우리가 생각하는 댓글의 내용이지.
- `createdAt`, `updatedAt`: 댓글이 언제 달렸고 언제 수정되었는지 알 수 있어야겠지?

### 2. 대댓글을 가능하게 해주는 마법

- `parentId`: 대댓글이 아닌 일반 댓글은 `parentId`가 `null`(없음)이야. 그런데 만약 대댓글이 달린다면? 이 대댓글은 댓글처럼 고유한 아이디를 가짐과 동시에 parentId라는게 주어지지. 한 마디로 대댓글은 자식이고 대댓글을 주렁주렁 달고 있는 댓글은 부모님이라는 거야. 부모님의 고유한 아이디를 대댓글이 품고 있는 거지. 등본 떼면 부모님 이름이 나오는 것처럼!
  
### 3. 수정과 삭제는 아무나 하나

- `user.id === comment.userId`: 내가 쓴 댓글에만 수정과 삭제 버튼이 보여야겠지? 관리자도 아닌데 다른 사람 댓글도 내키는 대로 삭제할 수 있다면 댓글이 난리가 나겠지. 그래서 댓글이 가지고 있는 유저의 정보가 현재 브라우저를 지켜보고 있는 유저와 같은 사람인지 판별하고 그에 따라 볼 수 있는 버튼이 달라져야 해. 스크린샷을 보면 내가 쓰지 않은 댓글에는 답글 버튼만 있고 내가 작성한 댓글에는 답글, 수정, 삭제 3가지가 보이지? 수정 버튼을 누르면 또 수정과 취소라는 버튼이 새로 생기지. 사용자가 도대체 뭘 하려고 하는 지 집요하게 따라붙어 정확한 버튼을 보여줘야 하는 고독한 싸움이야.

### 4. 댓글 작성 활성 상태

- `activeComment` or not?: 댓글을 작성하는 분홍색 입력창이 댓글이나 수정 버튼을 누르는 곳마다 열리고 댓글 작성이 완료된 후에도 열려있다고 생각해 봐. 몇 번 클릭하다 보면 결국엔 분홍색 네모가 너무 많아져서 보기 좋지 않을 거야. 그래서 활성 입력창은 한번에 하나만 열리게 해뒀어. 첫 번째 댓글에 답글 버튼을 눌렀다가 다른 댓글에 답글을 달기로 마음을 바꾸면 위의 활성창은 닫히고 아래에 새로 열리는 거야. 댓글 작성이 완료되면 당연히 분홍 활성창이 없어지고 새로운 댓글만 보여주고 말야.

### 5. 재깍재깍 업데이트

- 새로운 정보가 입력, 수정, 삭제되면 그걸 백엔드라 불리는 미지의 세계 데이터베이스로 넘겨줌과 동시에 브라우저에 새 정보가 업데이트가 되어야 하지. 우리는 모르지만 GET/PATCH/DELETE라는 요청과 응답이 끊임없이 오가야만 화면이 업데이트 되는 거야. 데이터를 받아오는 동안 당신의 기다림을 덜 지루하게 할 로딩 애니메이션도 띄워주고... 참 친절하다 친절해!  


> 다음 이야기
무언가를 수정하거나 삭제할 때 일일이 뜨는 확인창을 만드는 것에도 당신의 생각보다 복잡한 미학이 숨어있다는 사실!
